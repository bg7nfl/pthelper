(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof exports==="object"){module.exports=a}else{if(window.layui&&layui.define){layui.define("jquery",function(b){var c=layui.jquery;layui.link(layui.cache.base+"tagsInput/tagsInput.css");b("tagsInput",a(c))})}else{a(jQuery)}}}}(function(d){var e=d;var a=new Array();var c=new Array();d.fn.doAutosize=function(k){var h=d(this).data("minwidth"),r=d(this).data("maxwidth"),m="",q=d(this),l=d("#"+d(this).data("tester_id"));if(m===(m=q.val())){return}var g=m.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");l.html(g);var p=l.width(),n=(p+k.comfortZone)>=h?p+k.comfortZone:h,j=q.width(),f=(n<j&&n>=h)||(n>h&&n<r);if(f){q.width(n)}};d.fn.resetAutosize=function(h){var k=d(this).data("minwidth")||h.minInputWidth||d(this).width(),l=d(this).data("maxwidth")||h.maxInputWidth||(d(this).closest(".tagsinput").width()-h.inputPadding),m="",g=d(this),j=d("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:g.css("fontSize"),fontFamily:g.css("fontFamily"),fontWeight:g.css("fontWeight"),letterSpacing:g.css("letterSpacing"),whiteSpace:"nowrap"}),f=d(this).attr("id")+"_autosize_tester";if(!d("#"+f).length>0){j.attr("id",f);j.appendTo("body")}g.data("maxwidth",l);g.data("tester_id",f)};d.fn.addTag=function(g,f){f=e.extend({focus:false,callback:true},f);this.each(function(){var n=d(this).attr("id");var j=d(this).val().split(a[n]);if(j[0]==""){j=new Array()}g=e.trim(g);if(f.unique){var k=d(this).tagExist(g);if(k==true){d("#"+n+"_tag").addClass("not_valid")}}else{var k=false}if(g!=""&&k!=true){var h='<span class="default-close-text">&times;</span>';if(layui){h='<i class="layui-icon layui-icon-close"></i>'}d("<span>").addClass("tag").append(d("<span>").text(g).append("&nbsp;&nbsp;"),d("<a>",{href:"javascript:;",title:"移除",html:h}).click(function(){return d("#"+n).removeTag(escape(g))})).insertBefore("#"+n+"_addTag");j.push(g);d("#"+n+"_tag").val("");d("#"+n+"_tag").parent().find(".tagsinput-tip-list").remove();if(f.focus){d("#"+n+"_tag").focus()}else{d("#"+n+"_tag").blur()}d.fn.tagsInput.updateTagsField(this,j);if(f.callback&&c[n]&&c[n]["onAddTag"]){var m=c[n]["onAddTag"];m.call(this,g)}if(c[n]&&c[n]["onChange"]){var l=j.length;var m=c[n]["onChange"];m.call(this,d(this),j[l-1])}}});return false};d.fn.removeTag=function(f){f=unescape(f);this.each(function(){var j=d(this).attr("id");var g=d(this).val().split(a[j]);d("#"+j+"_tagsinput .tag").remove();str="";for(i=0;i<g.length;i++){if(g[i]!=f){str=str+a[j]+g[i]}}d.fn.tagsInput.importTags(this,str);if(c[j]&&c[j]["onRemoveTag"]){var h=c[j]["onRemoveTag"];h.call(this,f)}});return false};d.fn.tagExist=function(g){var h=d(this).attr("id");var f=d(this).val().split(a[h]);return(e.inArray(g,f)>=0)};d.fn.importTags=function(f){var g=d(this).attr("id");d("#"+g+"_tagsinput .tag").remove();d.fn.tagsInput.importTags(this,f)};d.fn.tagsInput=function(f){if(f&&f.skin=="tagsinput-default"&&f.focusWithClick==undefined){f.focusWithClick=false}var h=e.extend({interactive:true,defaultText:"+请输入",minChars:0,width:"",height:"",autocomplete:{type:"get",data:{}},hide:true,delimiter:",",unique:true,removeWithBackspace:false,focusWithClick:true,placeholderColor:"#666666",autosize:true,comfortZone:20,inputPadding:6*2,skin:""},f);var g=0;this.each(function(){if(typeof d(this).attr("data-tagsinput-init")!=="undefined"){return}d(this).attr("data-tagsinput-init",true);if(h.hide){d(this).hide();d(this).addClass("ew-tagsinput-hide")}var l=d(this).attr("id");if(!l||a[d(this).attr("id")]){l=d(this).attr("id","tags"+new Date().getTime()+(g++)).attr("id")}var k=e.extend({pid:l,real_input:"#"+l,holder:"#"+l+"_tagsinput",input_wrapper:"#"+l+"_addTag",fake_input:"#"+l+"_tag"},h);a[l]=k.delimiter;if(h.onAddTag||h.onRemoveTag||h.onChange){c[l]=new Array();c[l]["onAddTag"]=h.onAddTag;c[l]["onRemoveTag"]=h.onRemoveTag;c[l]["onChange"]=h.onChange}var j='<div id="'+l+'_tagsinput" class="tagsinput '+h.skin+'"><div id="'+l+'_addTag">';if(h.interactive){j=j+'<input id="'+l+'_tag" value="" placeholder="'+h.defaultText+'" autocomplete="off" />'}j=j+"</div></div>";d(j).insertAfter(this);d(k.holder).css("width",h.width);d(k.holder).css("min-height",h.height);d(k.holder).css("height",h.height);if(d(k.real_input).val()!=""){d.fn.tagsInput.importTags(d(k.real_input),d(k.real_input).val())}if(h.interactive){d(k.fake_input).resetAutosize(h);if(h.focusWithClick){d(k.holder).bind("click",k,function(m){d(m.data.fake_input).focus()})}if(h.autocomplete_url!=undefined){d(k.fake_input).on("input",function(){var m=d(this).val();if(!m){d(k.fake_input).parent().find(".tagsinput-tip-list").remove();return}h.autocomplete.data.name=m;d.ajax({url:h.autocomplete_url,type:h.autocomplete.type,data:h.autocomplete.data,dataType:"json",success:function(o){if(o.code==200){var q=d(k.fake_input).parent().find(".tagsinput-tip-list");if(o.data.length==0){q.remove()}var r="";for(var n=0;n<o.data.length;n++){var p=o.data[n];r+='<li data-value="'+p+'">'+p+"</li>"
}if(q.length<=0){d(k.fake_input).after('<ul class="tagsinput-tip-list"></ul>');q=d(k.fake_input).parent().find(".tagsinput-tip-list");q.on("click",">li",function(){var s=d(this).data("value");d("#"+l).addTag(s,{focus:true,unique:(h.unique)});q.remove()})}q.html(r)}else{console.error(o)}}})})}else{d(k.fake_input).bind("blur",k,function(m){if(d(m.data.fake_input).val()!=""){if((m.data.minChars<=d(m.data.fake_input).val().length)&&(!m.data.maxChars||(m.data.maxChars>=d(m.data.fake_input).val().length))){d(m.data.real_input).addTag(d(m.data.fake_input).val(),{focus:false,unique:(h.unique)})}}return false})}d(k.fake_input).bind("keypress",k,function(m){if(b(m)){m.preventDefault();if((m.data.minChars<=d(m.data.fake_input).val().length)&&(!m.data.maxChars||(m.data.maxChars>=d(m.data.fake_input).val().length))){d(m.data.real_input).addTag(d(m.data.fake_input).val(),{focus:true,unique:(h.unique)})}d(m.data.fake_input).resetAutosize(h);return false}else{if(m.data.autosize){d(m.data.fake_input).doAutosize(h)}}});k.removeWithBackspace&&d(k.fake_input).bind("keydown",function(n){if(n.keyCode==8&&d(this).val()==""){n.preventDefault();var m=d(this).closest(".tagsinput").find(".tag:last").text();var o=d(this).attr("id").replace(/_tag$/,"");m=m.replace(/[\s]+x$/,"");m=m.replace(/\s/g,"");d("#"+o).removeTag(escape(m));d(this).trigger("focus")}});d(k.fake_input).blur();if(k.unique){d(k.fake_input).keydown(function(m){if(m.keyCode==8||String.fromCharCode(m.which).match(/\w+|[áéíóúÁÉÍÓÚñÑ,/]+/)){d(this).removeClass("not_valid")}})}}});return this};d.fn.tagsInput.updateTagsField=function(g,f){var h=d(g).attr("id");d(g).val(f.join(a[h]))};d.fn.tagsInput.importTags=function(j,k){d(j).val("");var l=d(j).attr("id");var g=k.split(a[l]);for(i=0;i<g.length;i++){d(j).addTag(g[i],{focus:false,callback:false})}if(c[l]&&c[l]["onChange"]){var h=c[l]["onChange"];h.call(j,j,g[i])}};var b=function(f){var g=false;if(f.which==13){return true}if(typeof f.data.delimiter==="string"){if(f.which==f.data.delimiter.charCodeAt(0)){g=true}}else{d.each(f.data.delimiter,function(j,h){if(f.which==h.charCodeAt(0)){g=true}})}return g}}));